<!doctype html>

<html lang="en">

<head>

  <meta charset="utf-8"/>

  <meta name="viewport" content="width=device-width,initial-scale=1"/>

  <title>HelpAroundYou — Recent Requests</title>

  <link rel="stylesheet" href="styles.css"/>

</head>

<body>

  <header class="container header">

    <a class="brand" href="./">

      <svg viewBox="0 0 64 64" aria-hidden="true">

        <defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#C7C4FF"/><stop offset="1" stop-color="#7C73FF"/></linearGradient></defs>

        <circle cx="32" cy="32" r="28" fill="url(#g)"/><circle cx="23" cy="38" r="6" fill="#fff" opacity=".95"/>

        <path d="M44 18c-6 1-10 5-12 10 6-3 11-2 16 1-1-5-2-8-4-11z" fill="#fff" opacity=".95"/>

      </svg>

      <div class="name"><span class="tight">Help</span><span class="accent">Around</span><span class="tight">You</span></div>

    </a>

    <nav class="actions">

      <a class="btn btn-primary" href="post.html">Post a request</a>

    </nav>

  </header>



  <main class="container">

    <h1 style="font-size:32px;margin:8px 0 18px">Recent Requests</h1>



    <div id="list" class="grid"></div>

    <div id="fallback" class="card" style="display:none">

      Could not load requests yet. Please check back later.

    </div>

  </main>



  <script>

    // إذا عندك Endpoint للعرض اجعله يرجع JSON بشكل:

    // [{timestamp, title, description, category, location, date, contact}]

    const LIST_URL = "PUT_YOUR_WEB_APP_LIST_URL_HERE"; // مثال: WEB_APP_URL + "?action=list"



    async function load(){

      try{

        const r = await fetch(LIST_URL, {cache:'no-store'});

        if(!r.ok) throw new Error('http');

        const rows = await r.json();

        const wrap = document.getElementById('list');

        wrap.innerHTML = '';

        rows.slice(0,24).forEach(row=>{

          const card = document.createElement('div');

          card.className = 'card req';

          card.innerHTML = `

            <h4>${escapeHtml(row.title || '')}</h4>

            <p>${escapeHtml(row.description || '')}</p>

            <p class="hint">${escapeHtml(row.category || '')} • ${escapeHtml(row.location || '')} • ${escapeHtml(row.date || '')}</p>

          `;

          wrap.appendChild(card);

        });

        if(!rows.length){ document.getElementById('fallback').style.display='block'; }

      }catch(e){

        document.getElementById('fallback').style.display='block';

      }

    }

    function escapeHtml(s){return String(s||'').replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]))}

    load();

  </script>

</body>

</html>
